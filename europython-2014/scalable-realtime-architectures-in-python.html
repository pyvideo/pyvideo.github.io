<!DOCTYPE html>
<html lang="en">
<head>
      <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://use.fontawesome.com/2231f865fc.js"></script>
    <link rel="shortcut icon" href="https://pyvideo.org/theme/images/favicon.png">
    <meta name="google-site-verification" content="cHuieLjiIIDAHKKXSPPDsnbLEz9QgVNTi23qy_mOzDU" />

    <title>PyVideo.org &middot; Scalable Realtime Architectures in Python</title>

    <link href="https://pyvideo.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="PyVideo.org Full Atom Feed" />
    <link href="https://pyvideo.org/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="PyVideo.org Full RSS Feed" />
    <link href="https://pyvideo.org/feeds/event_europython-2014.atom.xml" type="application/atom+xml" rel="alternate" title="PyVideo.org Event Atom Feed" />
    <link href="https://pyvideo.org/feeds/event_europython-2014.rss.xml" type="application/rss+xml" rel="alternate" title="PyVideo.org Event RSS Feed" />

    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha256-7s5uDGW3AHqw6xtJmNNtr+OBRJUlgkNJEo78P4b0yRw= sha512-nNo+yCHEyn0smMxSswnf/OnX6/KwJuZTlNZBjauKhTK0c+zT+q5JOCx0UFhXQ6rJR9jg6Es8gPuD2uZcYDLqSw=="
          crossorigin="anonymous">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="/theme/css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="/theme/css/base.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->


  <meta property="og:site_name" content="PyVideo.org" />
  <meta property="og:title" content="Scalable Realtime Architectures in Python" />
  <meta property="og:type" content="video" />
  <meta property="og:url" content="https://pyvideo.org/europython-2014/scalable-realtime-architectures-in-python.html" />
    <meta property="og:image" content="https://i.ytimg.com/vi/Iw0MwPL2FCU/hqdefault.jpg" />
    <meta property="og:image:secure_url" content="https://i.ytimg.com/vi/Iw0MwPL2FCU/hqdefault.jpg" />
    <meta property="og:image:type" content="image/jpeg" />


</head>

<body>
<a class="github" href="https://github.com/pyvideo/pyvideo/wiki/How-to-Contribute-Media">
    <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 2;" src="/images/contribute_to_me_right_red_aa0000.png" alt="Contribute Media" />
</a>
  <div class="header notice clearfix">
    A thank you to everyone who makes this possible:
    <a href="/pages/thank-you-contributors.html">Read More</a>
  </div>
  <header id="banner" class="header clearfix">
    <nav class="header__nav"><div class="container">
      <ul class="nav">
        <li role="presentation">
          <a href="https://pyvideo.org/index.html"><i class="fa fa-fw fa-home"></i> <span>Start</span></a>
        </li>

        <li role="presentation" class="active">
          <a href="https://pyvideo.org/events.html"><i class="fa fa-fw fa-list-ul"></i> <span>Events</span></a>
        </li>

        <li role="presentation">
          <a href="https://pyvideo.org/tags.html"><i class="fa fa-fw fa-tags"></i> <span>Tags</span></a>
        </li>

        <li role="presentation">
          <a href="https://pyvideo.org/speakers.html"><i class="fa fa-fw fa-users"></i> <span>Speakers</span></a>
        </li>

          <li role="presentation"
>
            <a href="https://pyvideo.org/pages/about.html"><i class="fa fa-fw fa-info"></i> <span>About</span></a>
          </li>
          <li role="presentation"
style="display: none;">
            <a href="https://pyvideo.org/pages/thank-you-contributors.html"><i class="fa fa-fw fa-info"></i> <span>Thank You</span></a>
          </li>
          <li role="presentation"
style="display: none;">
            <a href="https://pyvideo.org/pages/thanks-will-and-sheila.html"><i class="fa fa-fw fa-info"></i> <span></span></a>
          </li>
      </ul>
    </div></nav>
    <div class="container">
      <h3 class="text-muted header__title">
      <a href="https://pyvideo.org/"><img src="/theme/images/logo.png" alt="" style="height:50px"> <span><i>Py</i>Video</span> <strong></strong></a>
      </h3>
      <div class="header__searchbox">
        <form method="GET" action="/search.html">
          <input name="q" type="search" placeholder="Search...">
        </form>
      </div>
    </div>
  </header>
  <div class="container">

<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="https://pyvideo.org/europython-2014/scalable-realtime-architectures-in-python.html" rel="bookmark"
         title="Permalink to Scalable Realtime Architectures in Python">Scalable Realtime Architectures in Python
      </a>
    </h2>
 
  </header>

  <footer class="post-info">
    <time class="published" datetime="2014-07-25T00:00:00+00:00">
      <i class="fa fa-calendar"></i> Fri 25 July 2014
    </time>
    <address class="vcard author">
      By
        <a class="url fn" href="https://pyvideo.org/speaker/jim-baker.html">Jim Baker</a>
    </address>
  </footer><!-- /.post-info -->

  <div class="entry-content">
<ul class="nav nav-tabs" role="tablist">
    <li class="active" role="presentation"><a href="#youtube" aria-controls="youtube" role="tab" data-toggle="tab">
        <i class="fa fa-fw fa-youtube"></i> YouTube
    </a></li>
</ul>

<div class="tab-content">
    <div role="tabpanel" class="tab-pane active" id="youtube">
        <div class="embed-responsive embed-responsive-16by9 videocontainer">
            <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/Iw0MwPL2FCU" title="Video for " frameborder="0" allowfullscreen></iframe>
        </div>
    </div>
</div>    <h3>Summary</h3><p>This talk will focus on you can readily implement highly scalable and
fault tolerant realtime architectures, such as dashboards, using Python
and tools like Storm, Kafka, and ZooKeeper. We will focus on two related
aspects: composing reliable systems using at-least-once and idempotence
semantics and how to partition for locality.</p>
<h3>Description</h3><p>Increasingly we are interested in implementing highly scalable and fault
tolerant realtime architectures such as the following:</p>
<ul class="simple">
<li>Realtime aggregation. This is the realtime analogue of working with
batched map-reduce in systems like Hadoop.</li>
<li>Realtime dashboards. Continuously updated views on all your
customers, systems, and the like, without breaking a sweat.</li>
<li>Realtime decision making. Given a set of input streams, policy on
what you like to do, and models learned by machine learning, optimize
a business process. One example includes autoscaling a set of
servers.</li>
</ul>
<p>(We use realtime in the soft sense: systems that are continuously
computing on input streams of data and make a best effort to keep up; it
certainly does not imply hard realtime systems that strictly bound their
computation times.)</p>
<p>Obvious tooling for such implementations include Storm (for event
processing), Kafka (for queueing), and ZooKeeper (for tracking and
configuration). Such components, written respectively in Clojure
(Storm), Scala (Kafka), and Java (ZooKeeper), provide the desired
scalability and reliability. But what may not be so obvious at first
glance is that we can work with other languages, including Python, for
the application level of such architectures. (If so inclined, you can
also try reimplementing such components in Python, but why not use
something that's been proven to be robust?)</p>
<p>In fact Python is likely a better language for the app level, given that
it is concise, high level, dynamically typed, and has great libraries.
Not to mention fun to write code in! This is especially true when we
consider the types of tasks we need to write: they are very much like
the data transformations and analyses we would have written of say a
standard Unix pipeline. And no one is going to argue that writing such a
filter in say Java is fun, concise, or even considerably faster in
running time.</p>
<p>So let's look at how you might solve such larger problems. Given that it
was straightforward to solve a small problem, we might approach as
follows. Simply divide up larger problems in small one. For example,
perhaps work with one customer at a time. And if failure is an ever
present reality, then simply ensure your code retries, just like you
might have re-run your pipeline against some input files.</p>
<p>Unfortunately both require distributed coordination at scale. And
distributed coordination is challenging, especially for real systems,
that will break at scale. Just putting a box in your architecture
labeled <strong>&quot;ZooKeeper&quot;</strong> doesn't magically solve things, even if
ZooKeeper can be a very helpful part of an actual solution.</p>
<p>Enter the Storm framework. While Storm certainly doesn't solve all
problems in this space, it can support many different types of realtime
architectures and works well with Python. In particular, Storm solves
two key problems for you.</p>
<p><strong>Partitioning</strong>. Storm lets you partition streams, so you can break
down the size of your problem. But if the a node running your code
fails, Storm will restart it. Storm also ensures such topology
invariants as the number of nodes (spouts and bolts in Storm's lingo)
that are running, making it very easy to recover from such failures.</p>
<p>This is where the cleverness really begins. What can you do if you can
ensure that <strong>all the data</strong> you need for a given continuously updated
computation - what is the state of this customer's account? - can be put
in <strong>exactly one place</strong>, then flow the supporting data through it over
time? We will look at how you can readily use such locality in your own
Python code.</p>
<p><strong>Retries</strong>. Storm tracks success and failure of events being processed
efficiently through a batching scheme and other cleverness. Your code
can then choose to retry as necessary. Although Storm also supports
exactly-once event processing semantics, we will focus on the simpler
model of at-least-once semantics. This means your code must tolerate
retry, or in a word, is idempotent. But this is straightforward. We have
often written code like the following:</p>
<pre class="literal-block">
seen = set()
for record in stream:
    k = uniquifier(record)
    if k not in seen:
       seen.add(k)
       process(record)
</pre>
<p>Except of course that any such real usage has to ensure it doesn't
attempt to store all observations (first, download the Internet! ;), but
removes them by implementing some sort of window or uses data structures
like HyperLogLog, as we will discuss.</p>
<p>One more aspect of reliability we will discuss is how to compose
reliable systems out of reliable components; we will show how this can
be readily done with a real example of consuming Kafka and tracking
consumption progress in ZooKeeper.</p>

  </div><!-- /.entry-content -->

<div class="details-content">
  <h3>Details</h3>
  <ul>
      <li>
        Event:
        <a href="https://pyvideo.org/events/europython-2014.html">EuroPython 2014</a>
      </li>
        <li>Language: English</li>
        <li>
            Media URL: <a href="https://www.youtube.com/watch?v=Iw0MwPL2FCU" rel="external">YouTube</a>        </li>

  </ul>
</div>
    <a href="https://github.com/pyvideo/data/blob/master/europython-2014/videos/scalable-realtime-architectures-in-python.json">
      <i class="fa fa-pencil-square-o"></i> Improve this page
    </a>

</section>

    <footer class="footer">
      <p>
        &copy;
        <a href="https://github.com/pyvideo/pyvideo/blob/master/LICENSE">PyVideo.org</a> |
        <a href="https://github.com/pyvideo/data/blob/master/LICENSE">pyvideo/data</a>
      </p>
    </footer>

      <script src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha256-KXn5puMvxCw+dAYznun+drMdG1IFl3agK0p/pqT9KAo= sha512-2e8qq0ETcfWRI4HJBzQiA3UoyFk6tbNyG+qSaIBZLyW9Xf3sWZHN/lxe9fTh1U45DpPf07yj94KsUHHWe4Yk1A==" crossorigin="anonymous"></script>
      <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
      <script src="/theme/js/ie10-viewport-bug-workaround.js"></script>
      <script src="/theme/js/thumb.js"></script>
      <script src="/theme/js/language.js"></script>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-72949800-2']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = 'https://ssl.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
  </div>
</body>
</html>