<!DOCTYPE html>
<html lang="en">
<head>
      <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://use.fontawesome.com/2231f865fc.js"></script>
    <link rel="shortcut icon" href="https://pyvideo.org/theme/images/favicon.png">
    <meta name="google-site-verification" content="cHuieLjiIIDAHKKXSPPDsnbLEz9QgVNTi23qy_mOzDU" />

    <title>PyVideo.org &middot; When generated code makes sense</title>

    <link href="https://pyvideo.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="PyVideo.org Full Atom Feed" />
    <link href="https://pyvideo.org/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="PyVideo.org Full RSS Feed" />
    <link href="https://pyvideo.org/feeds/event_pycon-fr-2015.atom.xml" type="application/atom+xml" rel="alternate" title="PyVideo.org Event Atom Feed" />
    <link href="https://pyvideo.org/feeds/event_pycon-fr-2015.rss.xml" type="application/rss+xml" rel="alternate" title="PyVideo.org Event RSS Feed" />

    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha256-7s5uDGW3AHqw6xtJmNNtr+OBRJUlgkNJEo78P4b0yRw= sha512-nNo+yCHEyn0smMxSswnf/OnX6/KwJuZTlNZBjauKhTK0c+zT+q5JOCx0UFhXQ6rJR9jg6Es8gPuD2uZcYDLqSw=="
          crossorigin="anonymous">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="/theme/css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="/theme/css/base.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->


  <meta property="og:site_name" content="PyVideo.org" />
  <meta property="og:title" content="When generated code makes sense" />
  <meta property="og:type" content="video" />
  <meta property="og:url" content="https://pyvideo.org/pycon-fr-2015/when-generated-code-makes-sense.html" />
    <meta property="og:image" content="http://video-pyconfr2015.paulla.asso.fr/023%20-%20Charlie%20Clark%20-%20When%20generated%20code%20makes%20sense.mp4.jpg" />
    <meta property="og:image:secure_url" content="https://video-pyconfr2015.paulla.asso.fr/023%20-%20Charlie%20Clark%20-%20When%20generated%20code%20makes%20sense.mp4.jpg" />
    <meta property="og:image:type" content="image/jpeg" />


</head>

<body>
<a class="github" href="https://github.com/pyvideo/pyvideo/wiki/How-to-Contribute-Media">
    <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 2;" src="/images/contribute_to_me_right_red_aa0000.png" alt="Contribute Media" />
</a>
  <div class="header notice clearfix">
    A thank you to everyone who makes this possible:
    <a href="/pages/thank-you-contributors.html">Read More</a>
  </div>
  <header id="banner" class="header clearfix">
    <nav class="header__nav"><div class="container">
      <ul class="nav">
        <li role="presentation">
          <a href="https://pyvideo.org/index.html"><i class="fa fa-fw fa-home"></i> <span>Start</span></a>
        </li>

        <li role="presentation" class="active">
          <a href="https://pyvideo.org/events.html"><i class="fa fa-fw fa-list-ul"></i> <span>Events</span></a>
        </li>

        <li role="presentation">
          <a href="https://pyvideo.org/tags.html"><i class="fa fa-fw fa-tags"></i> <span>Tags</span></a>
        </li>

        <li role="presentation">
          <a href="https://pyvideo.org/speakers.html"><i class="fa fa-fw fa-users"></i> <span>Speakers</span></a>
        </li>

          <li role="presentation"
>
            <a href="https://pyvideo.org/pages/about.html"><i class="fa fa-fw fa-info"></i> <span>About</span></a>
          </li>
          <li role="presentation"
style="display: none;">
            <a href="https://pyvideo.org/pages/thank-you-contributors.html"><i class="fa fa-fw fa-info"></i> <span>Thank You</span></a>
          </li>
          <li role="presentation"
style="display: none;">
            <a href="https://pyvideo.org/pages/thanks-will-and-sheila.html"><i class="fa fa-fw fa-info"></i> <span></span></a>
          </li>
      </ul>
    </div></nav>
    <div class="container">
      <h3 class="text-muted header__title">
      <a href="https://pyvideo.org/"><img src="/theme/images/logo.png" alt="" style="height:50px"> <span><i>Py</i>Video</span> <strong></strong></a>
      </h3>
      <div class="header__searchbox">
        <form method="GET" action="/search.html">
          <input name="q" type="search" placeholder="Search...">
        </form>
      </div>
    </div>
  </header>
  <div class="container">

<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="https://pyvideo.org/pycon-fr-2015/when-generated-code-makes-sense.html" rel="bookmark"
         title="Permalink to When generated code makes sense">When generated code makes sense
      </a>
    </h2>
 
  </header>

  <footer class="post-info">
    <time class="published" datetime="2015-10-18T00:00:00+00:00">
      <i class="fa fa-calendar"></i> Sun 18 October 2015
    </time>
    <address class="vcard author">
      By
        <a class="url fn" href="https://pyvideo.org/speaker/charlie-clark.html">Charlie Clark</a>
    </address>
  </footer><!-- /.post-info -->

  <div class="entry-content">
<ul class="nav nav-tabs" role="tablist">
    <li class="active" role="presentation"><a href="#ogv" aria-controls="ogv" role="tab" data-toggle="tab">
        <i class="fa fa-fw fa-file-video-o"></i> OGV
    </a></li>
    <li class="" role="presentation"><a href="#mp4" aria-controls="mp4" role="tab" data-toggle="tab">
        <i class="fa fa-fw fa-file-video-o"></i> MP4
    </a></li>
    <li class="" role="presentation"><a href="#webm" aria-controls="webm" role="tab" data-toggle="tab">
        <i class="fa fa-fw fa-file-video-o"></i> WEBM
    </a></li>
</ul>

<div class="tab-content">
    <div role="tabpanel" class="tab-pane active" id="ogv">
        <div class="embed-responsive embed-responsive-16by9 videocontainer">
            <video class="embed-responsive-item" controls>
                <source src="http://video-pyconfr2015.paulla.asso.fr/023%20-%20Charlie%20Clark%20-%20When%20generated%20code%20makes%20sense.ogv" type="video/ogv">
            </video>
        </div>
    </div>
    <div role="tabpanel" class="tab-pane" id="mp4">
        <div class="embed-responsive embed-responsive-16by9 videocontainer">
            <video class="embed-responsive-item" controls>
                <source src="http://video-pyconfr2015.paulla.asso.fr/023%20-%20Charlie%20Clark%20-%20When%20generated%20code%20makes%20sense.mp4" type="video/mp4">
            </video>
        </div>
    </div>
    <div role="tabpanel" class="tab-pane" id="webm">
        <a class="reference external image-reference"
           href="http://video-pyconfr2015.paulla.asso.fr/023%20-%20Charlie%20Clark%20-%20When%20generated%20code%20makes%20sense.webm">
            <img alt=""
                 src="http://video-pyconfr2015.paulla.asso.fr/023%20-%20Charlie%20Clark%20-%20When%20generated%20code%20makes%20sense.mp4.jpg">
        </a>
    </div>
</div>    <h3>Summary</h3><p>openpyxl started largely as the reverse-engineering of existing files.
While this allowed the project to get up and running quickly, it also
turned out to be a dead-end when it came to supporting more advanced
features. This talk will explain how we've shifted to using descriptors,
code generation and possibly the world's worst parser for more reliable
code and faster development.</p>
<h3>Description</h3><p>Only after a great deal of public pressure did Microsoft agree to make
the specification of Microsoft Office 2007 public and even this was
after the fact. The result was many thousands of pages of narrative
description and an extensive XML schema. Whatever one may think of the
company or the format, the fact remains that for many offices Microsoft
Excel is a standard format and we want to make it as easy as possible to
work with the files with Python.</p>
<p>openpyxl started largely as the reverse-engineering of existing files.
While this allowed the project to get up and running quickly, it also
turned out to be a dead-end when it came to supporting more advanced
features.</p>
<p>The Office Open XML Schema is, in effect, the domain-specific language
for Microsoft Office. With tools like lxml it's even possible to work
with this directly from Python but this requires extensive and detailed
knowledge of something that is rarely intuitive and often downright
confusing. Furthermore, manipulating XML in memory can be a problem on
very large workbooks.</p>
<p>In openpyxl we introduced descriptors to deal with common types in the
schema, and added class methods so that we could simplify parsing but
keep the Python API as simple as possible. This started out as a fairly
laborious transcription of schema to class definitions that has since
been replaced by code generated by what might possibly be the world's
worst parser â€“ every library has to have some horrible code in it
somewhere!</p>
<p>The result was that over 200 classes and their naive tests could be
generated automatically to provide near complete support for the chart
API. The process isn't perfect: code rarely runs straight out of the box
but it has made it possible to support features that otherwise could
only ever be partially supported at best.</p>
<p>The talk will cover what tools Python provides to make this kind of
adventure succeed and where things could be improved.</p>

  </div><!-- /.entry-content -->

<div class="details-content">
  <h3>Details</h3>
  <ul>
      <li>
        Event:
        <a href="https://pyvideo.org/events/pycon-fr-2015.html">PyCon FR 2015</a>
      </li>
        <li>Language: French</li>
        <li>
            Media URL: <a href="http://video-pyconfr2015.paulla.asso.fr/023%20-%20Charlie%20Clark%20-%20When%20generated%20code%20makes%20sense.ogv" rel="external">OGV</a>, <a href="http://video-pyconfr2015.paulla.asso.fr/023%20-%20Charlie%20Clark%20-%20When%20generated%20code%20makes%20sense.mp4" rel="external">MP4</a>, <a href="http://video-pyconfr2015.paulla.asso.fr/023%20-%20Charlie%20Clark%20-%20When%20generated%20code%20makes%20sense.webm" rel="external">WEBM</a>        </li>

  </ul>
</div>
    <a href="https://github.com/pyvideo/data/blob/master/pycon-fr-2015/videos/when-generated-code-makes-sense.json">
      <i class="fa fa-pencil-square-o"></i> Improve this page
    </a>

</section>

    <footer class="footer">
      <p>
        &copy;
        <a href="https://github.com/pyvideo/pyvideo/blob/master/LICENSE">PyVideo.org</a> |
        <a href="https://github.com/pyvideo/data/blob/master/LICENSE">pyvideo/data</a>
      </p>
    </footer>

      <script src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha256-KXn5puMvxCw+dAYznun+drMdG1IFl3agK0p/pqT9KAo= sha512-2e8qq0ETcfWRI4HJBzQiA3UoyFk6tbNyG+qSaIBZLyW9Xf3sWZHN/lxe9fTh1U45DpPf07yj94KsUHHWe4Yk1A==" crossorigin="anonymous"></script>
      <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
      <script src="/theme/js/ie10-viewport-bug-workaround.js"></script>
      <script src="/theme/js/thumb.js"></script>
      <script src="/theme/js/language.js"></script>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-72949800-2']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = 'https://ssl.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
  </div>
</body>
</html>